/*! For license information please see 180.e34fffa378d0d6f6b068.bundle.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[180],{180:function(t,e,n){"use strict";n.d(e,{l:function(){return q}});var r={main:0,mountain:1,network:2,montreal:3};var o=function(){var t=this;this.dottedness=1,this.nodeness=0,this.gridness=0,this.toponess=0;var e=1,n=0,o=0,i=0,a=.3;this.update=function(r){var s=r/a,c=function(t,e){return t==e?t:t>e?Math.max(0,t-s):Math.min(1,t+s)};t.dottedness=c(t.dottedness,e),t.nodeness=c(t.nodeness,n),t.gridness=c(t.gridness,o),t.toponess=c(t.toponess,i)},this.target=function(s,c){switch(a=c,r[s]){case r.mountain:t.activeScene=s,e=1,n=0,o=1,i=0;break;case r.network:t.activeScene=s,e=1,n=1,o=0,i=0;break;case r.montreal:t.activeScene=s,e=1,n=0,o=0,i=1;break;case r.main:t.activeScene=s;default:e=1,n=0,o=0,i=0}}};function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function s(t){for(var e=new Array(Math.pow(t,2)).fill(0),n=0;n<t;n++)e[t*n+n]=1;return e}function c(t,e){for(var n=e[0],r=e[1],o=e[2],i=0;i<4;i++)t[i+12]=t[i]*n+t[i+4]*r+t[i+8]*o+t[i+12];return t}function f(t,e,n){var r=i(t),o=n[0],a=n[1],s=n[2],c=Math.hypot(o,a,s);if(!(c<1e-6)){o*=c=1/c,a*=c,s*=c;var f=Math.sin(e),l=Math.cos(e),u=1-l,h=new Array(9).fill(0);h[0]=o*o*u+l,h[1]=a*o*u+s*f,h[2]=s*o*u-a*f,h[3]=o*a*u-s*f,h[4]=a*a*u+l,h[5]=s*a*u+o*f,h[6]=o*s*u+a*f,h[7]=a*s*u-o*f,h[8]=s*s*u+l;for(var d=0;d<3;d++)for(var v=0;v<4;v++)r[4*d+v]=t[v]*h[3*d]+t[4+v]*h[1+3*d]+t[8+v]*h[2+3*d];return r}}var l=function(){var t=this,e=c(s(4),[-.5,0,-6]);this.pjMatrix=null,this.mvMatrix=e,this.viewWidth=null,this.viewHeight=null,this.renderScale=1,this.renderHeight=null,this.renderWidth=null,this.resized=!1,this.pitch=0,this.pitchOffset=0,this.yaw=0,this.yawOffset=0,this.roll=0,this.offsetX=-.5,this.offsetY=0,this.offsetZ=-6,this.updateNudge=function(e,r){t.pitchOffset=.05*e,t.yawOffset=.05*r,n()},this.updateAngle=function(e,r,o,i,a,s){t.pitch=e,t.yaw=r,t.roll=o,t.offsetX=i,t.offsetY=a,t.offsetZ=s,n()},this.updateRenderScale=function(e){e!=t.renderScale&&(t.renderScale=e,r())},this.updateSize=function(e,n){e==t.viewWidth&&n==t.viewHeight||(t.viewWidth=e,t.viewHeight=n,r(),t.aspectRatio=e/n,o(),t.resized=!0)};var n=function(){t.mvMatrix=c(s(4),[t.offsetX,t.offsetY,t.offsetZ]),t.mvMatrix=f(t.mvMatrix,t.pitch+t.pitchOffset,[1,0,0]),t.mvMatrix=f(t.mvMatrix,t.yaw+t.yawOffset,[0,1,0]),t.mvMatrix=f(t.mvMatrix,t.roll,[0,0,1])},r=function(){t.renderWidth=t.viewWidth*t.renderScale,t.renderHeight=t.viewHeight*t.renderScale},o=function(){t.pjMatrix=function(t,e,n,r){var o=new Array(16).fill(0),i=1/Math.tan(t/2);if(o[0]=i/e,o[5]=i,o[11]=-1,null!=r&&r!==1/0){var a=1/(n-r);o[10]=(r+n)*a,o[14]=2*r*n*a}else o[10]=-1,o[14]=-2*n;return o}(45,t.aspectRatio,.1,1e3)};this.offset=0,this.positions=[1,1,1,1,1,-1,1,-1,1,1,-1,-1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,-1],this.len=8};var u=function(t){var e=this;this.camera=t,this.targetFPS=60;var n=!1,r=!1,o=0,i=Date.now(),a=0,s=0,c=null,f=Date.now(),l=0;this.timeDelta=0,this.fixedTimeDelta=0,this.frameReady=function(){return f=Date.now(),(l=f-i)>a},this.frameStart=function(){i=f-l%a,e.timeDelta=l/1e3},this.frameEnd=function(){var t=Date.now()-f;c=c||t,s++,c+=(t-c)/s,e.evalFrameTime()},this.evalFrameTime=function(){s<3*e.targetFPS||(2*c>1/e.targetFPS*1e3&&!n&&(e.decreaseRenderQuality(),r=!1),6*c<1/e.targetFPS*1e3&&!r&&o<6&&(o++,e.increaseRenderQuality(),n=!1))},this.decreaseRenderQuality=function(){s=0,c=null,60!=e.targetFPS?1!=e.camera.renderScale&&.75!=e.camera.renderScale?n=!0:e.camera.updateRenderScale(.5):e.setFPS(30)},this.increaseRenderQuality=function(){s=0,c=null,.5!=e.camera.renderScale?.75!=e.camera.renderScale?(1==e.camera.renderScale&&30==e.targetFPS&&e.setFPS(60),r=!0):e.camera.updateRenderScale(1):e.camera.updateRenderScale(.75)},this.setFPS=function(t){t!=e.targetFPS&&(e.targetFPS=t,u())};var u=function(){a=1e3/e.targetFPS,e.fixedTimeDelta=.1/(e.targetFPS/30)/3*2};u()},h="uniform mat4 pjMatrix;\nuniform mat4 mvMatrix;\nuniform float screenScale;\n\nuniform vec2 sheens[6];\nuniform float nodeness; // 0≤r≤1 transition\nuniform float gridness; // 0≤r≤1 transition\nuniform float toponess; // 0≤r≤1 transition\n\nattribute vec3 position;\nattribute float nconnection;\nattribute vec2 topology;\nattribute float height;\n\nvarying vec4 vColor;\nvarying float isDotted;\nvarying float isLined;\nvarying vec2 texcoord;\n\nconst float maxDist = 3.0;\nconst float minPSize = 0.2;\nconst float maxPSize = 0.65;\nconst float connPSize = 1.5;\nconst float connHOffs = 0.075;\n\n\nconst vec3 distSharpness = vec3(4.0, 4.0, 5.0);\nconst vec3 distWidth = vec3(0.8, 0.8, 1.5);\nconst mat3 LINE_COLORS = %lineColors%;\n\n\nfloat demap(float val, float minOut, float maxOut){\n  return clamp((val - minOut) / (maxOut - minOut), 0.0, 1.0);\n}\nvec3 remap(vec3 val, float minOut, mat3 maxOut){\n  return clamp(val, vec3(0.0), vec3(1.0)) * (maxOut - minOut) + minOut;\n}\nvec3 easeInOut(vec3 x, vec3 p){\n  vec3 xp = pow(clamp(x, 0.0, 1.0), p);\n  return xp / (xp + pow(1.0 - x, p));\n}\nfloat distToVec(vec2 point, vec2 angle, vec2 origin){\n  return abs(dot(point - origin, normalize(vec2(angle.y,-angle.x))));\n}\nfloat distToVecAlt(vec2 P, vec2 slope, vec2 O){\n    vec2 D = normalize(slope);\n    vec2 X = D * dot(P-O, D) + O;\n    return abs(distance(P, X));\n}\n\nfloat fogged(float z){\n  const float fogstarts = 4.0;\n  const float fogends = 8.0;\n  return clamp((z - fogstarts) / (fogends - fogstarts), 0.0, 1.0);\n}\n\nvoid main()\n{\n  float isGrided = 1.0 - abs(sign(nconnection));  // [0, 1]\n  float isNoded = max(0.0, sign(nconnection)); // [0, 1]\n  float isTopoed = clamp(-nconnection - 1.0, 0.0, 1.0); // [0, 1]\n\n  float nodeFactor = isNoded * nodeness; // 0≤r≤1 transition\n  float topoFactor = isTopoed * toponess; // 0≤r≤1 transition\n\n  // Effect calcs - grid\n  float gridHeight = max(0.0, position.z - height);\n  float gridHeightOffset = gridHeight * gridness; // 0≤r≤gridHeight\n\n  // Effect calcs - nodes\n  float connFactor = nodeFactor * nconnection; // 0≤r≤1\n  float nodeHeightOffset = connHOffs * connFactor; // [0, 0.075]\n  float nodeRadiusOffset = connPSize * connFactor; // [0, 1.5]\n\n  // Effect calcs - topography\n  float topoAlphaMask = max(1.0 - toponess, (toponess * topology.y * 2.0));\n  float topoDotSize = (topology.y - 0.75) * toponess * 1.4; // need opt\n  float topoHeightFreeze = topology.y * -0.5 + 1.0;\n  float topoHeightTarget = max(-0.1, topology.x - 0.6) * 0.65 * toponess; // need opt\n  float topoHeightOffset = (height * topoHeightFreeze + topoHeightTarget - height) * toponess;\n\n  isDotted = clamp(1.0 - gridHeightOffset, nodeFactor, 1.0); // 0≤r≤1\n  isLined = clamp(min(1.0, (gridHeightOffset* 3.0)) * isGrided, max(topoFactor, nodeFactor), 1.0);\n\n  // POSITION\n  float z = height + gridHeightOffset + nodeHeightOffset + topoHeightOffset;\n  gl_Position = pjMatrix * mvMatrix * vec4(position.x, z, position.y, 1.0);\n\n  // POINT SIZE\n  float agnosticPointSize = mix(minPSize, maxPSize, min(z * 5.0, 1.0));\n  float scale = screenScale * .01;\n  gl_PointSize = isDotted * max(agnosticPointSize + nodeRadiusOffset, topoDotSize) * scale;\n\n  // COLORS\n  float minZ = vec4(pjMatrix * mvMatrix * vec4(0.0, 0.0, 0.0, 1.0)).z;\n  float maxZ = vec4(pjMatrix * mvMatrix * vec4(-maxDist, 0.0, -maxDist, 1.0)).z;\n  float fog = 1.0 - gridness * fogged(gl_Position.z);\n\n  vec3 vdist = vec3(distToVec(position.xy, sheens[1], sheens[0]),\n                    distToVec(position.xy, sheens[3], sheens[2]),\n                    distToVec(position.xy, sheens[5], sheens[4]));\n\n  vec3 distVec = min((vdist + distWidth) / maxDist, 1.0);\n  distVec = 1.0 - easeInOut(distVec, distSharpness);\n\n  vColor = vec4(remap(distVec, 0.35, LINE_COLORS), topoAlphaMask * fog);\n}\n",d="precision mediump float;\nvarying vec4 vColor;\nvarying float isLined;\n\nvoid main() // LINES\n{\n  gl_FragColor = vec4(vColor.rgb, isLined);\n}\n",v=n(190),p=n.n(v),g=51;function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function y(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return w(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function b(){b=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof y?e:y,a=Object.create(i.prototype),s=new _(r||[]);return o(a,"_invoke",{value:F(t,n,s)}),a}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",d="suspendedYield",v="executing",p="completed",g={};function y(){}function w(){}function S(){}var x={};f(x,a,(function(){return this}));var A=Object.getPrototypeOf,E=A&&A(A(D([])));E&&E!==n&&r.call(E,a)&&(x=E);var P=S.prototype=y.prototype=Object.create(x);function T(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function M(t,e){function n(o,i,a,s){var c=u(t[o],t,i);if("throw"!==c.type){var f=c.arg,l=f.value;return l&&"object"==m(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(l).then((function(t){f.value=t,a(f)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function F(e,n,r){var o=h;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===p){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=O(s,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=v;var f=u(e,n,r);if("normal"===f.type){if(o=r.done?p:d,f.arg===g)continue;return{value:f.arg,done:r.done}}"throw"===f.type&&(o=p,r.method="throw",r.arg=f.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=u(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(m(e)+" is not iterable")}return w.prototype=S,o(P,"constructor",{value:S,configurable:!0}),o(S,"constructor",{value:w,configurable:!0}),w.displayName=f(S,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,f(t,c,"GeneratorFunction")),t.prototype=Object.create(P),t},e.awrap=function(t){return{__await:t}},T(M.prototype),f(M.prototype,s,(function(){return this})),e.AsyncIterator=M,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new M(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(P),f(P,c,"Generator"),f(P,a,(function(){return this})),f(P,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=D,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),f=r.call(a,"finallyLoc");if(c&&f){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!f)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),R(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;R(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function S(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function x(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){S(i,r,o,a,s,"next",t)}function s(t){S(i,r,o,a,s,"throw",t)}a(void 0)}))}}Math.floor(g/2);var A,E,P,T,M,F,O,L,R,_=[],D=null,k=[],C=null,z=[],I=!1;var H=function(t,e,r,o,i,a,s,c){var f=this;this.scene=t,this.camera=e,this.ticker=r,this.waves=o,this.grid=i,this.nodes=a,this.roads=s,this.sheens=c,this.grid.offset=this.waves.len,this.nodes.offset=this.waves.len+this.grid.len,this.roads.offset=this.waves.len+this.grid.len+this.nodes.len,new Array(g*g),this.loseCTX=function(){E.loseContext()},this.initWebGL=function(t){M=t,A=t.getContext("webgl")||t.getContext("experimental-webgl"),E=A.getExtension("WEBGL_lose_context"),t.addEventListener("webglcontextrestored",f.start),t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),setTimeout((function(){E.restoreContext()}))}),!1)},this.initTextures=function(t){T=t,P=t.getContext("2d",{willReadFrequently:!0})},this.initShaders=function(){C=A.createProgram(),D=A.createProgram(),A.createProgram();var t=A.createShader(A.VERTEX_SHADER),e=A.createShader(A.VERTEX_SHADER),n=A.createShader(A.FRAGMENT_SHADER),r=A.createShader(A.FRAGMENT_SHADER),o=A.createShader(A.FRAGMENT_SHADER);h=h.replace(/\%lineColors\%/g,"mat3("+f.sheens.str+")"),A.shaderSource(t,h),A.shaderSource(e,"uniform mat4 pjMatrix;\nuniform mat4 mvMatrix;\nuniform float screenScale;\n\nattribute vec3 debugPosition;\n\nvarying vec4 vColor;\nvarying float isDotted;\nvarying float isLined;\n\nvoid main()\n{\n\n  // POS\n  vec4 pos = vec4(debugPosition.x, debugPosition.y, debugPosition.z, 1.0);\n  gl_Position = pjMatrix * mvMatrix * pos;\n\n  // SCALE\n  float scale = screenScale / 100.0;\n  gl_PointSize = 1.0 * scale;\n\n  // COLOR\n  isDotted = 1.0;\n  isLined = 1.0;\n  vColor = vec4(1.0, 1.0, 1.0, 1.0);\n}\n"),A.shaderSource(n,d),A.shaderSource(r,"precision mediump float;\nvarying vec4 vColor;\nvarying float isDotted;\n\nfloat circle(in vec2 _st){\n  vec2 dist = _st-vec2(0.5);\n  return 1.-smoothstep(0.8, 1.1, dot(dist,dist)*6.0);\n}\n\nvoid main() // DOTS\n{\n  gl_FragColor = vColor * vec4(1.0, 1.0, 1.0, isDotted * circle(gl_PointCoord.xy));\n}\n"),A.shaderSource(o,d),A.compileShader(t),A.compileShader(e),A.compileShader(n),A.compileShader(r),A.compileShader(o),A.attachShader(D,t),A.attachShader(D,n),A.attachShader(C,t),A.attachShader(C,r),A.linkProgram(C),A.linkProgram(D),A.disable(A.DEPTH_TEST),A.enable(A.BLEND),A.blendFunc(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA)};var l=function(){var t=x(b().mark((function t(){var e,r,o;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=fetch,t.next=3,n.e(309).then(n.t.bind(n,309,17));case 3:return t.t1=t.sent.default,t.t2={mode:"cors"},t.next=7,(0,t.t0)(t.t1,t.t2);case 7:return e=t.sent,t.next=10,e.blob();case 10:return r=t.sent,t.next=13,createImageBitmap(r,{premultiplyAlpha:"none",colorSpaceConversion:"none"});case 13:return o=t.sent,T.width=o.width,T.height=o.height,P.drawImage(o,0,0,o.width,o.height),t.abrupt("return",Array.from({length:g*g},(function(t,e){var n=Math.floor(e/g),r=e%g,o=n/g*T.width,i=r/g*T.height,a=P.getImageData(o,i,1,1);return[a.data[1]/256,a.data[2]/256]})).flat());case 18:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),u=function(){var t=S(f.grid.idTable,f.waves.heights,1),e=S(f.nodes.idTable,f.waves.heights,1),n=S(f.roads.idTable,f.waves.heights,1);return[].concat(y(f.waves.heights),y(t),y(e),y(n))},v=function(){var t=x(b().mark((function t(){var e,n,r,o;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l();case 2:return e=t.sent,n=S(f.grid.idTable,e,2),r=S(f.nodes.idTable,e,2),o=S(f.roads.idTable,e,2),t.abrupt("return",[].concat(y(e),y(n),y(r),y(o)));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),m=function(){var t=Array.from({length:g*g},(function(t,e){var n=Math.floor(e/g),r=e%g,o=Math.sin((n/g*1.25-.125)*Math.PI)*Math.sin((r/g*1.25-.125)*Math.PI)*2-.7;return[.12*(-g/2+n),.12*(-g/2+r),o+.25*p().noise(n/g*20,r/g*15,0)]})).flat(),e=S(f.nodes.idTable,t,3),n=S(f.grid.idTable,t,3),r=S(f.roads.idTable,t,3);return[].concat(y(t),y(n),y(e),y(r))},w=function(){for(var t,e,n,r=m(),o=(t=new Array(f.grid.idTable.length).fill(0),e=S(f.nodes.idTable,f.nodes.connections,1),n=new Array(f.roads.idTable.length).fill(-2),[].concat(y(f.nodes.connections),y(t),y(e),y(n))),i=[],a=0;a<o.length;a++)i.push(r[3*a]),i.push(r[3*a+1]),i.push(r[3*a+2]),i.push(o[a]);return i};function S(t,e,n){for(var r=new Array(t.length),o=0;o<t.length;o++)for(var i=0;i<n;i++)r[o*n+i]=e[t[o]*n+i];return r}this.initBuffers=function(){function t(t,e){e[0]=A.getUniformLocation(t,"pjMatrix"),e[1]=A.getUniformLocation(t,"mvMatrix"),e[2]=A.getUniformLocation(t,"screenScale"),e[3]=A.getUniformLocation(t,"sheens"),e[4]=A.getUniformLocation(t,"nodeness"),e[5]=A.getUniformLocation(t,"gridness"),e[6]=A.getUniformLocation(t,"toponess")}var e=function(){var t=x(b().mark((function t(){var e,n,r;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v();case 2:e=t.sent,O=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,O),A.bufferData(A.ARRAY_BUFFER,new Float32Array(e),A.STATIC_DRAW),n=2*Float32Array.BYTES_PER_ELEMENT,0,r=n,_[2]=A.getAttribLocation(C,"topology"),A.enableVertexAttribArray(_[2]),A.vertexAttribPointer(_[2],2,A.FLOAT,!1,r,0);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(function(){var t=w();F=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,F),A.bufferData(A.ARRAY_BUFFER,new Float32Array(t),A.STATIC_DRAW);var e=3*Float32Array.BYTES_PER_ELEMENT,n=0+e,r=e+1*Float32Array.BYTES_PER_ELEMENT;_[0]=A.getAttribLocation(C,"position"),A.enableVertexAttribArray(_[0]),A.vertexAttribPointer(_[0],3,A.FLOAT,!1,r,0),_[1]=A.getAttribLocation(C,"nconnection"),A.enableVertexAttribArray(_[1]),A.vertexAttribPointer(_[1],1,A.FLOAT,!1,r,n)})(),e(),R=u(),L=A.createBuffer(),A.bindBuffer(A.ARRAY_BUFFER,L),A.bufferData(A.ARRAY_BUFFER,new Float32Array(R),A.DYNAMIC_DRAW),_[3]=A.getAttribLocation(C,"height"),A.enableVertexAttribArray(_[3]),A.vertexAttribPointer(_[3],1,A.FLOAT,!1,Float32Array.BYTES_PER_ELEMENT,0),A.useProgram(C),t(C,z),f.setImage(),A.useProgram(D),t(D,k)},this.setImage=x(b().mark((function t(){return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:I;case 1:case"end":return t.stop()}}),t)}))),this.render=function(){if(requestAnimationFrame(f.render),f.ticker.frameReady()){f.ticker.frameStart(),f.camera.resized&&(M.width=f.camera.viewWidth,M.height=f.camera.viewHeight,A.viewport(0,0,f.camera.viewWidth,f.camera.viewHeight),f.camera.resized=!1),f.scene.update(f.ticker.timeDelta),f.sheens.update(f.ticker.timeDelta),f.waves.update(f.ticker.fixedTimeDelta);var t=Array.from(f.sheens.array,(function(t,e){return[].concat(y(t.origin),y(t.angle))})).flat(),e=function(e){A.uniformMatrix4fv(e[0],!1,f.camera.pjMatrix),A.uniformMatrix4fv(e[1],!1,f.camera.mvMatrix),A.uniform1f(e[2],f.camera.renderHeight),A.uniform2fv(e[3],new Float32Array(t)),A.uniform1f(e[4],f.scene.nodeness),A.uniform1f(e[5],f.scene.gridness),A.uniform1f(e[6],f.scene.toponess)};R=u(),A.useProgram(C),A.bindBuffer(A.ARRAY_BUFFER,L);Float32Array.BYTES_PER_ELEMENT,Float32Array.BYTES_PER_ELEMENT;A.bufferSubData(A.ARRAY_BUFFER,0,new Float32Array(R)),e(z),A.drawArrays(A.POINTS,f.waves.offset,f.waves.len),A.useProgram(D),A.bindBuffer(A.ARRAY_BUFFER,L),e(k),A.drawArrays(A.LINES,f.grid.offset,f.grid.len+f.roads.len+f.nodes.len),A.flush(),f.ticker.frameEnd()}},this.start=function(){f.initBuffers(),f.render()}},N=Math.floor(g/2);var j=function(){var t=this,e=new Array(3),n=0,r=!0,o=.033;this.setInertia=function(t){n=t},this.setPositions=function(i){var c=i.x,f=i.y,l=i.z,u=i.sigma2;if(r)for(var h=0;h<3;h++){e[h]=new Array(g);for(var d=0;d<g;d++)e[h][d]=new Array(g)}for(var v=0;v<3;v++)for(var p=0;p<g;p++)for(var m=0;m<g;m++){var y=6*(-N+p),w=6*(-N+m),b=l*Math.exp(-(Math.pow(y-c,2)+Math.pow(w-f,2))/(2*u));e[0][p][m]=r||Math.abs(b)>Math.abs(e[0][p][m])?b:e[0][p][m]}for(var S=1;S<50;S++)for(var x=1;x<50;x++)e[1][S][x]=n*e[0][S][x]+8*o*o/1*(e[0][S+1][x]+e[0][S-1][x]+e[0][S][x+1]+e[0][S][x-1]-4*e[0][S][x]);a(1),s(1),r=!1,t.heights=new Array(g*g)},this.update=function(t){o=t;for(var r=1;r<g/2;r++)for(var c=1;c<g/2;c++)e[2][r][c]=n*(2*e[1][r][c]-e[0][r][c]+16*o*o/1*(e[1][r+1][c]+e[1][r-1][c]+e[1][r][c+1]+e[1][r][c-1]-4*e[1][r][c])),e[2][g-r-1][g-c-1]=e[2][r][c],e[2][r][g-c-1]=e[2][r][c],e[2][g-r-1][c]=e[2][r][c];a(2),s(2),i()};var i=function(){for(var n=0;n<g;n++)for(var r=0;r<g;r++)e[0][n][r]=e[1][n][r],e[1][n][r]=e[2][n][r],t.heights[n*g+r]=.02*e[1][n][r]},a=function(t){for(var n=1;n<50;n++)e[t][n][0]=e[t][n][1],e[t][n][50]=e[t][n][49],e[t][0][n]=e[t][1][n],e[t][50][n]=e[t][49][n]},s=function(t){e[t][0][0]=(e[t][0][1]+e[t][1][0])/2,e[t][0][50]=(e[t][0][49]+e[t][1][50])/2,e[t][50][0]=(e[t][49][0]+e[t][50][1])/2,e[t][50][50]=(e[t][49][50]+e[t][50][49])/2};this.offset=0,this.len=g*g};var B=function(){for(var t=0,e=new Array(7600),n=0;n<g;n++)for(var r=0;r<g;r++)n<50&&(e[t++]=n*g+r,e[t++]=(n+1)*g+r),n<50&&r<50&&(e[t++]=n*g+r,e[t++]=(n+1)*g+r+1),r<50&&(e[t++]=n*g+r,e[t++]=n*g+r+1);this.offset=0,this.idTable=e,this.len=e.length};var Y=function(){var t=this,e=[];this.connections=new Array(g*g).fill(0);for(var n=0;n<g*g;n++)this.connections[n]=Math.max(0,Math.floor(64*Math.random())-62);for(var r=function(n,r){if(t.connections[r]>0)return e.push(n),e.push(r),!0},o=0;o<g;o++)for(var i=0;i<g;i++){var a=o*g+i;if(0!=this.connections[a])for(var s=0,c=0;s<this.connections[a]+1&&c<g;){for(var f=0;f<c;f++){var l=i+f,u=o+c-f,h=o-c+f;l<g&&u<g&&r(a,u*g+l)&&s++,l<g&&h>=0&&r(a,h*g+l)&&s++}c++}}this.offset=0,this.len=e.length,this.idTable=e},U=[40,295,295,446,446,647,647,749,749,1051,1051,1407,1407,1509,1509,1610,1610,1658,1658,1706,1706,1857,1857,2005,2005,2104,2104,2252,2252,2300,2300,2348,2348,2346,1632,1639,1639,1900,1900,2055,2055,2209,2209,2569,51,882,882,883,883,1038,1038,1140,1140,1453,1453,1606,1606,1658,26,126,126,329,329,327,327,528,528,675,675,776,776,925,925,1076,1076,1074,1074,1326,204,931,931,986,986,988,988,1041,1041,1197,1197,1248,1248,1508,1508,1610,1610,1714,1714,1869,45,146,146,195,195,397,397,954,954,1158,1158,1413,1413,1669,1669,1920,1920,2020,2020,2070,2070,2168,2168,2166,2166,2313,2313,2310,2310,2358,2358,2456,2456,2403,2403,2450,2450,2448,1768,1869,1869,1968,1968,2067,2067,2065,2065,2113,2113,2111,2111,2209,2209,2257,2257,2304,2304,2399,2399,2450,18,272,272,377,377,429,429,583,583,636,636,788,788,838,838,1040,1040,1141,1141,1241,1241,1342,1342,1392,1392,1543,1543,1641,1641,1639,628,889,889,1099,1099,1307,1307,1411,1411,1412,1158,1259,1259,1409,1409,1509,816,869,869,971,971,1076,1076,1129,1129,1234,1234,1392,1392,1548,1548,1652,1652,1755,1755,2065,2584,2329,2329,2175,2175,2022,2022,2020,1325,1471,1471,1623,1623,1672,1672,1669,2022,1973,1973,1824,1824,1672,2070,2224,2224,2175,2578,2426,2426,2325,2325,2224,2567,2469,2469,2419,2419,2370,2370,2320,2320,2322,2322,2377,2377,2430,2430,2484,2484,2487,2487,2389,2389,2341,2341,2293,2293,2294,1623,1776,1776,1930,1930,2084,2084,2238,2238,2341,1631,1782,1782,1881,1881,1930,1543,1752,1752,1958,1958,2113];var W=function(){this.offset=0,this.idTable=U,this.len=this.idTable.length};function G(t,e,n){return(n-e)*t+e}var V=[[1,0,.2],[.2,.8,.4],[1,1,1]],X=Array.from({length:9},(function(t,e){return V[e%3][Math.floor(e/3)]})).join();var Z=function(){var t=this;this.str=X,this.array=[{inactive:!0,angle:[0,1],origin:[-4,-4],speed:0},{inactive:!0,angle:[0,1],origin:[-4,-4],speed:0},{inactive:!0,angle:[0,1],origin:[-4,-4],speed:0}],this.respawn=!1,this.active=!1,this.nextWave=null,this.set=function(e){t.active=!0,void 0!==(null==e?void 0:e.respawn)&&(t.respawn=e.respawn);var n=G(Math.random(),10,70)/45*2;if(t.array.forEach((function(t){var e=G((Math.random()+1)/2,-1.5,1.5);t.inactive=!1,t.speed=G(n/3+e,1,4),t.angle=[4*e-n,1],t.origin=[-4-4*e,-4-4*e]})),e&&e.sheens)for(var r=0;r<e.sheens.length;r++)Object.assign(t.array[r],e.sheens[r]);clearTimeout(t.nextWave)},this.update=function(n){t.active&&(t.active=!1,t.array.forEach((function(r){!r.inactive&&e(r,n),t.active=t.active||!r.inactive})),!t.active&&t.respawn&&(t.nextWave=setTimeout(t.set,2e3+3e3*Math.random())))};var e=function(t,e){var n=t.speed*e;t.angle[0]=Math.min(-.25,t.angle[0]+n/10),t.origin[0]+=n,t.origin[1]+=n,t.inactive=Math.max(t.origin[0],t.origin[1])>4}},Q={initialize:0,start:1,setSize:2,setInertia:3,setPositions:4,setSheens:5,setFPS:6,setProgress:7,setScene:8,loseCTX:9,setCamOffset:10,setCamAngle:11};var q=new function(){var t=new o,e=new l,n=new u(e),r=new j,i=new B,a=new Z,s=new Y,c=new W,f=new H(t,e,n,r,i,s,c,a);return this.init=function(t,e){f.initWebGL(t),f.initTextures(e),f.initShaders()},this.run=function(o,i){switch(Q[o]){case Q.start:f.start();break;case Q.setSize:e.updateSize(i.width,i.height);break;case Q.setProgress:f.setProgress(i);break;case Q.setCamOffset:e.updateNudge(i.pitchOffset,i.yawOffset);break;case Q.setCamAngle:e.updateAngle(i.pitch,i.yaw,i.roll,i.offsetX,i.offsetY,i.offsetZ);break;case Q.setInertia:r.setInertia(1-i*n.targetFPS/30);break;case Q.setPositions:r.setPositions(i);break;case Q.setSheens:a.set(i);break;case Q.setScene:t.target(i.name,i.speed);break;case Q.setFPS:n.setFPS(i);break;case Q.loseCTX:f.loseCTX()}},this}},190:function(t,e){var n,r,o;"undefined"!=typeof self&&self,r=[],void 0===(o="function"==typeof(n=function(){return function(){"use strict";function t(t){t||(t=Math.random);const e=new Array(256).fill(1).map((function(t,e){return e}));for(let n=e.length-1;n>0;--n){const r=Math.floor(t()*(n+1)),o=e[r];e[r]=e[n],e[n]=o}return e}const e=[1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1];function n(n,r,o){null==n||"function"==typeof n?n=t(n):256!==n.length&&(console.error("create(): Expected array of length 256, got ",n),n=t());for(let t=0;t<256;++t)r[t]=n[t],r[t+256]=n[t];let i=0;for(let t=0;t<r.length;++t){const n=r[t]%12*3;o[i++]=e[n],o[i++]=e[n+1],o[i++]=e[n+2]}}const r=512,o=3*r,i=r+o;function a(t){const e=new ArrayBuffer(i),a=new Uint8Array(e,0,r),s=new Int8Array(e,r,o);function c(t,e,n,r,o,i){t=+t,e=+e,n=+n;const c=((r|=0)-1&255)>>>0,f=((o|=0)-1&255)>>>0,l=((i|=0)-1&255)>>>0,u=Math.floor(t),h=Math.floor(e),d=Math.floor(n),v=u+1&c,p=h+0&f,g=h+1&f,m=d+0&l,y=d+1&l,w=((6*(t-=u)-15)*t+10)*t*t*t,b=((6*(e-=h)-15)*e+10)*e*e*e,S=((6*(n-=d)-15)*n+10)*n*n*n,x=a[u+0&c],A=a[v],E=a[x+p],P=a[x+g],T=a[A+p],M=a[A+g],F=3*a[E+m],O=3*a[E+y],L=3*a[P+m],R=3*a[P+y],_=3*a[T+m],D=3*a[T+y],k=3*a[M+m],C=3*a[M+y],z=s[F]*(t+0)+s[F+1]*(e+0)+s[F+2]*(n+0),I=s[O]*(t+0)+s[O+1]*(e+0)+s[O+2]*(n-1),H=s[L]*(t+0)+s[L+1]*(e-1)+s[L+2]*(n+0),N=s[R]*(t+0)+s[R+1]*(e-1)+s[R+2]*(n-1),j=s[_]*(t-1)+s[_+1]*(e+0)+s[_+2]*(n+0),B=s[D]*(t-1)+s[D+1]*(e+0)+s[D+2]*(n-1),Y=s[k]*(t-1)+s[k+1]*(e-1)+s[k+2]*(n+0),U=z+(I-z)*S,W=j+(B-j)*S,G=U+(H+(N-H)*S-U)*b;return G+(W+(Y+(s[C]*(t-1)+s[C+1]*(e-1)+s[C+2]*(n-1)-Y)*S-W)*b-G)*w}return n(t,a,s),c}const s=a([23,125,161,52,103,117,70,37,247,101,203,169,124,126,44,123,152,238,145,45,171,114,253,10,192,136,4,157,249,30,35,72,175,63,77,90,181,16,96,111,133,104,75,162,93,56,66,240,8,50,84,229,49,210,173,239,141,1,87,18,2,198,143,57,225,160,58,217,168,206,245,204,199,6,73,60,20,230,211,233,94,200,88,9,74,155,33,15,219,130,226,202,83,236,42,172,165,218,55,222,46,107,98,154,109,67,196,178,127,158,13,243,65,79,166,248,25,224,115,80,68,51,184,128,232,208,151,122,26,212,105,43,179,213,235,148,146,89,14,195,28,78,112,76,250,47,24,251,140,108,186,190,228,170,183,139,39,188,244,246,132,48,119,144,180,138,134,193,82,182,120,121,86,220,209,3,91,241,149,85,205,150,113,216,31,100,41,164,177,214,153,231,38,71,185,174,97,201,29,95,7,92,54,254,191,118,34,221,131,11,163,99,234,81,227,147,156,176,17,142,69,12,110,62,27,255,0,194,59,116,242,252,19,21,187,53,207,129,64,135,61,40,167,237,102,223,106,159,197,189,215,137,36,32,22,5]);return{create:a,noise:s}}()})?n.apply(e,r):n)||(t.exports=o)}}]);